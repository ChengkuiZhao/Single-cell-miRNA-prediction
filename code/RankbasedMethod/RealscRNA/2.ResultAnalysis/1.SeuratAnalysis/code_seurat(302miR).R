library(dplyr)
library(Seurat)
library(patchwork)
load(file='miRNAscore(302miR).Rdata')
load(file='data_label.Rdata')
tnbc_Allmir <- CreateSeuratObject(counts = miRNA_score_select, project = "tnbc_Allmir", min.cells = 3)
VlnPlot(tnbc_Allmir, features = c("nFeature_RNA", "nCount_RNA"), ncol = 2)
tnbc_Allmir <- FindVariableFeatures(tnbc_Allmir, selection.method = "vst", nfeatures = 50)
top10 <- head(VariableFeatures(tnbc_Allmir), 10)
plot1 <- VariableFeaturePlot(tnbc_Allmir)
plot2 <- LabelPoints(plot = plot1, points = top10, repel = TRUE)
plot1 + plot2
all.genes <- rownames(tnbc_Allmir)
tnbc_Allmir <- ScaleData(tnbc_Allmir, features = all.genes)
##tnbc_Allmir <- RunPCA(tnbc_Allmir, features = all.genes)
tnbc_Allmir <- RunPCA(tnbc_Allmir, features = VariableFeatures(object = tnbc_Allmir))
ElbowPlot(tnbc_Allmir)
tnbc_Allmir <- FindNeighbors(tnbc_Allmir, dims = 1:10)
tnbc_Allmir <- FindClusters(tnbc_Allmir, resolution = 0.5)
tnbc_Allmir <- RunUMAP(tnbc_Allmir, dims = 1:10)
Cluster_Orig=Idents(tnbc_Allmir)
DimPlot(tnbc_Allmir, reduction = "umap",label = T,pt.size = 5,label.size = 10)
Idents(tnbc_Allmir)=factor(label_new)
DimPlot(tnbc_Allmir, reduction = "umap",label = T,pt.size = 5,label.size = 10)
Idents(tnbc_Allmir)=Cluster_Orig
###Finding differentially expressed features
cluster0.markers <- FindMarkers(tnbc_Allmir, ident.1 = 0, min.pct = 0.25)
cluster0.markers_pos <- FindMarkers(tnbc_Allmir, ident.1 = 0, min.pct = 0.25,only.pos = T)
cluster1.markers <- FindMarkers(tnbc_Allmir, ident.1 = 1, min.pct = 0.25)
cluster1.markers_pos <- FindMarkers(tnbc_Allmir, ident.1 = 1, min.pct = 0.25,only.pos = T)
cluster2.markers <- FindMarkers(tnbc_Allmir, ident.1 = 2, min.pct = 0.25)
cluster2.markers_pos <- FindMarkers(tnbc_Allmir, ident.1 = 2, min.pct = 0.25,only.pos = T)
cluster3.markers <- FindMarkers(tnbc_Allmir, ident.1 = 3, min.pct = 0.25)
cluster3.markers_pos <- FindMarkers(tnbc_Allmir, ident.1 = 3, min.pct = 0.25,only.pos = T)
cluster4.markers <- FindMarkers(tnbc_Allmir, ident.1 = 4, min.pct = 0.25)
cluster4.markers_pos <- FindMarkers(tnbc_Allmir, ident.1 = 4, min.pct = 0.25,only.pos = T)
cluster5.markers <- FindMarkers(tnbc_Allmir, ident.1 = 5, min.pct = 0.25)
cluster5.markers_pos <- FindMarkers(tnbc_Allmir, ident.1 = 5, min.pct = 0.25,only.pos = T)
head(cluster0.markers, n = 5)
head(cluster1.markers, n = 5)
head(cluster2.markers, n = 5)
head(cluster3.markers, n = 5)
head(cluster4.markers, n = 5)
head(cluster5.markers, n = 5)
###Plot For Each Cluster
FeaturePlot(tnbc_Allmir, features = c('hsa-miR-200c-3p',"hsa-miR-25-3p",'hsa-miR-93-5p','hsa-miR-1271-5p'),pt.size = 1,cols = c("blue", "red"))
FeaturePlot(tnbc_Allmir, features = c('hsa-miR-18a-3p',"hsa-let-7f-1-3p",'hsa-miR-98-3p','hsa-miR-107'),pt.size = 1,cols = c("blue", "red"))
FeaturePlot(tnbc_Allmir, features = c('hsa-miR-374c-5p',"hsa-miR-599",'hsa-miR-653-5p','hsa-miR-382-3p'),pt.size = 1,cols = c("blue", "red"))
FeaturePlot(tnbc_Allmir, features = c('hsa-let-7f-1-3p',"hsa-miR-98-3p",'hsa-miR-18a-3p','hsa-miR-296-3p'),pt.size = 1,cols = c("blue", "red"))
FeaturePlot(tnbc_Allmir, features = c('hsa-miR-34a-5p',"hsa-miR-218-5p",'hsa-miR-29c-3p','hsa-miR-212-3p'),pt.size = 1,cols = c("blue", "red"))
FeaturePlot(tnbc_Allmir, features = c('hsa-miR-99b-5p',"hsa-miR-128-3p",'hsa-miR-100-5p','hsa-miR-129-5p'),pt.size = 1,cols = c("blue", "red"))
####
clusterN.markers <- FindMarkers(tnbc_Allmir, ident.1 = 'non-malignantcells', min.pct = 0.25)
clusterN.markers_pos <- FindMarkers(tnbc_Allmir, ident.1 = 'non-malignantcells', min.pct = 0.25,only.pos = T)
clusterM.markers <- FindMarkers(tnbc_Allmir, ident.1 = 'malignantcells', min.pct = 0.25)
clusterM.markers_pos <- FindMarkers(tnbc_Allmir, ident.1 = 'malignantcells', min.pct = 0.25,only.pos = T)
head(clusterN.markers_pos, n = 5)
head(clusterM.markers_pos, n = 5)
FeaturePlot(tnbc_Allmir, features = c('hsa-miR-495-3p',"hsa-miR-212-3p",'hsa-miR-211-5p','hsa-miR-212-3p'),pt.size = 1,cols = c("blue", "red"))
FeaturePlot(tnbc_Allmir, features = c('hsa-miR-296-3p',"hsa-let-7d-5p",'hsa-miR-18a-3p','hsa-let-7f-1-3p'),pt.size = 1,cols = c("blue", "red"))
